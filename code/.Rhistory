library(tidyverse)
dat <- read_csv("../data/data_final.csv")
dat
library(caret)
install.packages("caret")
library(caret)
cv <- createFolds(y, k = 10, list = TRUE, returnTrain = FALSE)
cv <- createFolds(dat, k = 5, list = TRUE, returnTrain = FALSE)
cv
dat
?createFolds
cv <- createFolds(c(1:100), k = 5, list = TRUE, returnTrain = FALSE)
cv
N <- nrow(dat)
cv <- createFolds(N, k = 5, list = TRUE, returnTrain = FALSE)
cv
cv <- createFolds(c(1:N), k = 5, list = TRUE, returnTrain = FALSE)
cv
names(cv)[1]
cv[1]
length(cv[1])
dim(cv[1])
dat[cv[1],]
as.vector(cv[1])
length(as.vector(cv[1]))
cv[2]
cv[[1]]
dat[cv[[1]],]
X <- dat[,2:6]
y <- dat[,7]
X_train <- X[cv[[i]]]
i = 1
X_train <- X[cv[[i]]]
X_train <- X[cv[[i]],]
X_train <- X[-cv[[i]],]
y_train <- y[-cv[[i]],]
X_test <- X[cv[[i]],]
y_test <- y[cv[[i]],]
dim(X_train)
dim(X_test)
?lm
model <- lm(y_train~X_train)
y_train
X <- as.matrix(dat[,2:6])
y <- as.matrix(dat[,7])
X_train <- X[-cv[[i]],]
y_train <- y[-cv[[i]],]
X_test <- X[cv[[i]],]
y_test <- y[cv[[i]],]
model <- lm(y_train~X_train)
model
?predict
y_fit <- predict(model, X_test)
X <- as.data.frame(dat[,2:6])
y <- as.data.frame(dat[,7])
X_train <- X[-cv[[i]],]
y_train <- y[-cv[[i]],]
X_test <- X[cv[[i]],]
y_test <- y[cv[[i]],]
model <- lm(y_train~X_train)
X_train
type(X_train)
class(X_train)
model <- lm(y_train~X_train)
X_train
X <- dat[,2:6]
y <- dat[,7]
cv <- createFolds(c(1:N), k = 5, list = TRUE, returnTrain = FALSE)
i = 1
X_train <- X[-cv[[i]],]
y_train <- y[-cv[[i]],]
X_test <- X[cv[[i]],]
y_test <- y[cv[[i]],]
model <- lm(y_train~X_train)
y_train
dat
y_train
X_train
?lm
train <- X[-cv[[i]],2:7]
train <- dat[-cv[[i]],2:7]
train <- dat[-cv[[i]],2:7]
test <- dat[cv[[i]],2:7]
train
model <- lm(stars~S1+S2+S3+S4+S5)
model <- lm(stars~S1+S2+S3+S4+S5, train)
test
y_fit <- predict(model, test[,1:5])
y_fit
sum((y_fit-test[,6])^2)/length(y_fit)
sse <- 0
for(i in 1:5){
train <- dat[-cv[[i]],2:7]
test <- dat[cv[[i]],2:7]
model <- lm(stars~S1+S2+S3+S4+S5, train)
y_fit <- predict(model, test[,1:5])
sse <- sse + sum((y_fit-test[,6])^2)
}
sse/nrow(dat)
